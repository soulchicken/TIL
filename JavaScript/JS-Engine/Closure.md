# 클로저 (closure)

- **클로저** : 함수와 외부 변수와의 관계
- 클로저 문제 → 스코프, 비동기, var
- 반복문과 비동기를 함께 사용하면 종종 발생

## var, for, 비동기를 같이 쓰면 나오는 문제

```jsx
function a() {
  for (var i = 0; i < 5; i++) {
    setTimeout(() => {
      console.log(i);
    }, i * 1000);
  }
}

a();
// 5가 5번 출력
```

- `var`를 `let`으로 바꾸거나 즉시실행함수로 감싸서 실행하면 해결 됨
- var는 블록으로 구분짓지 않고 함수에 따라 들어가게 된다. 그래서 `i++`로 마지막에 생기는 `i = 5`로 마지막에 출력된다.
- 신기한 점은 `i * 1000`은 기가막히게 0, 1, 2, 3, 4가 들어간다.

### 즉시 실행 함수

```jsx
function a() {
  for (var i = 0; i < 5; i++) {
    (function (j) {
      // var j = i가 된다.
      setTimeout(() => {
        console.log(j);
      }, i * 1000);
    })(i);
  }
}

a();
```
